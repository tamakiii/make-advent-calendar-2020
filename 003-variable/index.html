<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/make-advent-calendar-2020/styles.d14239cfe23303796d77.css">/*! modern-normalize v1.0.0 | MIT License | https://github.com/sindresorhus/modern-normalize */:root{-moz-tab-size:4;tab-size:4}html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji}hr{height:0;color:inherit}abbr[title]{text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace,SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,select{text-transform:none}button{-webkit-appearance:button}legend{padding:0}progress{vertical-align:baseline}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}button{background-color:transparent;background-image:none}button:focus{outline:1px dotted;outline:5px auto -webkit-focus-ring-color}fieldset,ol,ul{margin:0;padding:0}ol,ul{list-style:none}html{font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;line-height:1.5}body{font-family:inherit;line-height:inherit}*,:after,:before{box-sizing:border-box;border:0 solid #e5e7eb}hr{border-top-width:1px}img{border-style:solid}textarea{resize:vertical}input::placeholder,textarea::placeholder{color:#9ca3af}button{cursor:pointer}table{border-collapse:collapse}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}button,input,optgroup,select,textarea{padding:0;line-height:inherit;color:inherit}code,kbd,pre,samp{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}.border-gray-200{--tw-border-opacity:1;border-color:rgba(229,231,235,var(--tw-border-opacity))}.rounded-md{border-radius:.375rem}.border-b{border-bottom-width:1px}.block{display:block}.flex{display:flex}.table{display:table}.grid{display:grid}.hidden{display:none}.flex-wrap{flex-wrap:wrap}.items-center{align-items:center}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.font-medium{font-weight:500}.font-semibold{font-weight:600}.h-8{height:2rem}.text-xs{font-size:.75rem;line-height:1rem}.text-sm{font-size:.875rem;line-height:1.25rem}.text-base{font-size:1rem;line-height:1.5rem}.text-2xl{font-size:1.5rem;line-height:2rem}.list-disc{list-style-type:disc}.mx-auto{margin-left:auto;margin-right:auto}.mt-1{margin-top:.25rem}.ml-2{margin-left:.5rem}.mt-4{margin-top:1rem}.mb-4{margin-bottom:1rem}.mb-8{margin-bottom:2rem}.min-h-screen{min-height:100vh}.min-w-0{min-width:0}.overflow-hidden{overflow:hidden}.overflow-y-auto{overflow-y:auto}.p-4{padding:1rem}.px-1{padding-left:.25rem;padding-right:.25rem}.py-2{padding-top:.5rem;padding-bottom:.5rem}.py-4{padding-top:1rem;padding-bottom:1rem}.px-6{padding-left:1.5rem;padding-right:1.5rem}.py-8{padding-top:2rem;padding-bottom:2rem}.pt-4{padding-top:1rem}.pr-4{padding-right:1rem}.pt-6{padding-top:1.5rem}.pl-8{padding-left:2rem}.pb-10{padding-bottom:2.5rem}.relative{position:relative}.sticky{position:sticky}.top-0{top:0}.bottom-0{bottom:0}*{--tw-shadow:0 0 transparent}.shadow-sm{--tw-shadow:0 1px 2px 0 rgba(0,0,0,0.05)}.shadow,.shadow-sm{box-shadow:var(--tw-ring-offset-shadow,0 0 transparent),var(--tw-ring-shadow,0 0 transparent),var(--tw-shadow)}.shadow{--tw-shadow:0 1px 3px 0 rgba(0,0,0,0.1),0 1px 2px 0 rgba(0,0,0,0.06)}*{--tw-ring-inset:var(--tw-empty,/*!*/ /*!*/);--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(14,165,233,0.5);--tw-ring-offset-shadow:0 0 transparent;--tw-ring-shadow:0 0 transparent}.text-center{text-align:center}.text-gray-200{--tw-text-opacity:1;color:rgba(229,231,235,var(--tw-text-opacity))}.text-gray-300{--tw-text-opacity:1;color:rgba(209,213,219,var(--tw-text-opacity))}.text-gray-500{--tw-text-opacity:1;color:rgba(107,114,128,var(--tw-text-opacity))}.text-blue-600{--tw-text-opacity:1;color:rgba(2,132,199,var(--tw-text-opacity))}.text-red-500{--tw-text-opacity:1;color:rgba(244,63,94,var(--tw-text-opacity))}.hover\:text-gray-900:hover{--tw-text-opacity:1;color:rgba(17,24,39,var(--tw-text-opacity))}.truncate{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.w-10{width:2.5rem}.w-full{width:100%}.w-screen{width:100vw}.z-40{z-index:40}.z-50{z-index:50}.gap-4{gap:1rem}.grid-flow-col{grid-auto-flow:column}.grid-cols-1{grid-template-columns:repeat(1,minmax(0,1fr))}.grid-cols-12{grid-template-columns:repeat(12,minmax(0,1fr))}.col-span-2{grid-column:span 2/span 2}.col-span-12{grid-column:span 12/span 12}.transition-colors{transition-property:background-color,border-color,color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.duration-200{transition-duration:.2s}@keyframes spin{to{transform:rotate(1turn)}}@keyframes ping{75%,to{transform:scale(2);opacity:0}}@keyframes pulse{50%{opacity:.5}}@keyframes bounce{0%,to{transform:translateY(-25%);animation-timing-function:cubic-bezier(.8,0,1,1)}50%{transform:none;animation-timing-function:cubic-bezier(0,0,.2,1)}}.markdown{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji;font-size:1.125rem;line-height:1.75rem}@media (min-width:976px){.markdown{font-size:1rem;line-height:1.5rem}}.markdown .gatsby-highlight{margin-bottom:1rem}.markdown>h1{font-size:1.875rem;line-height:2.25rem}.markdown>h1,.markdown>h2{font-weight:600;margin-bottom:.5rem;margin-top:2rem}.markdown>h2{font-size:1.5rem;line-height:2rem}.markdown>h3{font-weight:600;font-size:1.25rem;line-height:1.75rem;margin-bottom:.5rem;margin-top:2rem}.markdown>h4{font-weight:600}.markdown>h4,.markdown>h5{margin-bottom:2rem;margin-top:4rem}.markdown>h5{font-size:.875rem;line-height:1.25rem}.markdown>h6{font-size:.75rem;line-height:1rem;margin-bottom:2rem;margin-top:4rem}.markdown a,.markdown a code,.markdown a code.language-text{--tw-text-opacity:1;color:rgba(2,132,199,var(--tw-text-opacity))}.markdown>p{margin-bottom:1rem}.markdown>blockquote{margin-bottom:2rem;margin-left:-2rem}.markdown ul{list-style-type:disc;padding-left:1.5rem}.markdown>ul,.markdown ol{margin-bottom:2rem}.markdown ol{list-style-type:decimal}.markdown hr{margin-bottom:1rem}.markdown blockquote{--tw-border-opacity:1;border-color:rgba(229,231,235,var(--tw-border-opacity));border-left-width:4px;margin-left:0;padding-left:1rem;--tw-text-opacity:1;color:rgba(107,114,128,var(--tw-text-opacity));font-style:italic}.markdown code.language-text{--tw-bg-opacity:1;background-color:rgba(243,244,246,var(--tw-bg-opacity));--tw-text-opacity:1;color:rgba(17,24,39,var(--tw-text-opacity))}@media (min-width:480px){.sm\:px-2{padding-left:.5rem;padding-right:.5rem}.sm\:px-3{padding-left:.75rem;padding-right:.75rem}}@media (min-width:768px){.md\:w-auto{width:auto}}@media (min-width:976px){.lg\:block{display:block}.lg\:text-sm{font-size:.875rem;line-height:1.25rem}.lg\:max-w-4xl{max-width:56rem}.lg\:py-8{padding-top:2rem;padding-bottom:2rem}.lg\:pr-2{padding-right:.5rem}.lg\:w-5\/6{width:83.333333%}.lg\:grid-flow-row{grid-auto-flow:row}.lg\:grid-cols-7{grid-template-columns:repeat(7,minmax(0,1fr))}.lg\:grid-rows-5{grid-template-rows:repeat(5,minmax(0,1fr))}}code[class*=language-],pre[class*=language-]{text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;color:#90a4ae;background:#fafafa;font-family:Roboto Mono,monospace;font-size:1em;line-height:1.5em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-]::-moz-selection,code[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection{background:#cceae7;color:#263238}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{background:#cceae7;color:#263238}:not(pre)>code[class*=language-]{white-space:normal;border-radius:.2em;padding:.1em}pre[class*=language-]{overflow:auto;position:relative;margin:.5em 0;padding:1.25em 1em}.language-css>code,.language-sass>code,.language-scss>code{color:#f76d47}[class*=language-] .namespace{opacity:.7}.token.atrule{color:#7c4dff}.token.attr-name{color:#39adb5}.token.attr-value,.token.attribute{color:#f6a434}.token.boolean{color:#7c4dff}.token.builtin,.token.cdata,.token.char,.token.class{color:#39adb5}.token.class-name{color:#6182b8}.token.comment{color:#aabfc9}.token.constant{color:#7c4dff}.token.deleted{color:#e53935}.token.doctype{color:#aabfc9}.token.entity{color:#e53935}.token.function{color:#7c4dff}.token.hexcode{color:#f76d47}.token.id,.token.important{color:#7c4dff;font-weight:700}.token.inserted{color:#39adb5}.token.keyword{color:#7c4dff}.token.number{color:#f76d47}.token.operator{color:#39adb5}.token.prolog{color:#aabfc9}.token.property{color:#39adb5}.token.pseudo-class,.token.pseudo-element{color:#f6a434}.token.punctuation{color:#39adb5}.token.regex{color:#6182b8}.token.selector{color:#e53935}.token.string{color:#f6a434}.token.symbol{color:#7c4dff}.token.tag{color:#e53935}.token.unit{color:#f76d47}.token.url,.token.variable{color:#e53935}</style><meta name="generator" content="Gatsby 2.26.1"/><link rel="preconnect dns-prefetch" href="https://www.google-analytics.com"/><title data-react-helmet="true">変数 | Makefile Advent Calendar 2020</title><meta data-react-helmet="true" name="description" content="変数 変数は make の特徴的な2つの側面に大きく関わる要素です。「O&#x27;Reilly GNU Make 第3版」3章の冒頭からの引用です。 make がある意味で2つの言語を1つにしたものだと理解することは重要です。
1つはターゲットを必須項目から成る依存関係グラフを表現します。 もう1つはテキストの置換を行うマク…"/><meta data-react-helmet="true" property="og:title" content="変数"/><meta data-react-helmet="true" property="og:description" content="変数 変数は make の特徴的な2つの側面に大きく関わる要素です。「O&#x27;Reilly GNU Make 第3版」3章の冒頭からの引用です。 make がある意味で2つの言語を1つにしたものだと理解することは重要です。
1つはターゲットを必須項目から成る依存関係グラフを表現します。 もう1つはテキストの置換を行うマク…"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="volunteers"/><meta data-react-helmet="true" name="twitter:title" content="変数"/><meta data-react-helmet="true" name="twitter:description" content="変数 変数は make の特徴的な2つの側面に大きく関わる要素です。「O&#x27;Reilly GNU Make 第3版」3章の冒頭からの引用です。 make がある意味で2つの言語を1つにしたものだと理解することは重要です。
1つはターゲットを必須項目から成る依存関係グラフを表現します。 もう1つはテキストの置換を行うマク…"/><link rel="icon" href="/make-advent-calendar-2020/favicon-32x32.png?v=4a9773549091c227cd2eb82ccd9c5e3a" type="image/png"/><link rel="manifest" href="/make-advent-calendar-2020/manifest.webmanifest" crossorigin="anonymous"/><meta name="theme-color" content="#663399"/><link rel="apple-touch-icon" sizes="48x48" href="/make-advent-calendar-2020/icons/icon-48x48.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="72x72" href="/make-advent-calendar-2020/icons/icon-72x72.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="96x96" href="/make-advent-calendar-2020/icons/icon-96x96.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="144x144" href="/make-advent-calendar-2020/icons/icon-144x144.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="192x192" href="/make-advent-calendar-2020/icons/icon-192x192.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="256x256" href="/make-advent-calendar-2020/icons/icon-256x256.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="384x384" href="/make-advent-calendar-2020/icons/icon-384x384.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="512x512" href="/make-advent-calendar-2020/icons/icon-512x512.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link as="script" rel="preload" href="/make-advent-calendar-2020/webpack-runtime-c00f8d02308ea544b904.js"/><link as="script" rel="preload" href="/make-advent-calendar-2020/framework-83e11af5cf111be5ad89.js"/><link as="script" rel="preload" href="/make-advent-calendar-2020/app-f6a66f2b14543ebf23ed.js"/><link as="script" rel="preload" href="/make-advent-calendar-2020/styles-407fe62976dc5310c43e.js"/><link as="script" rel="preload" href="/make-advent-calendar-2020/commons-783e0f477cc80a177ea6.js"/><link as="script" rel="preload" href="/make-advent-calendar-2020/component---src-templates-markdown-js-4b34ef1e8d6d1952574a.js"/><link as="fetch" rel="preload" href="/make-advent-calendar-2020/page-data/003-variable/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/make-advent-calendar-2020/page-data/sq/d/3649515864.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/make-advent-calendar-2020/page-data/sq/d/63159454.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/make-advent-calendar-2020/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="min-h-screen"><header><div class="sticky top-0 z-40 z-50 py-4 px-6 border-b border-gray-200"><div class="items-center"><a class="overflow-hidden w-10 md:w-auto" href="/make-advent-calendar-2020/"><h1 class="text-2xl">Makefile Advent Calendar 2020</h1></a></div></div></header><main><section class="w-full mx-auto grid grid-cols-12 grid-flow-col gap-4"><section class="col-span-2 lg:block hidden"><nav class="px-1 overflow-y-auto font-medium text-base sm:px-3 lg:text-sm pt-4 pb-10"><ul><li class="mt-4"><ul class="list-disc pl-8"><li><a class="py-2 transition-colors duration-200 relative block hover:text-gray-900 text-gray-500" href="/make-advent-calendar-2020/001-makefile-in-2020"><p>2020年の Makefile</p></a></li><li><a class="py-2 transition-colors duration-200 relative block hover:text-gray-900 text-gray-500" href="/make-advent-calendar-2020/002-phony-target-and-prerequisites"><p>偽のターゲットと前提条件</p></a></li><li><a aria-current="page" class="py-2 transition-colors duration-200 relative block hover:text-gray-900 text-gray-500" href="/make-advent-calendar-2020/003-variable"><p>変数</p></a></li><li><a class="py-2 transition-colors duration-200 relative block hover:text-gray-900 text-gray-500" href="/make-advent-calendar-2020/004-automatic-variable"><p>自動変数</p></a></li><li><a class="py-2 transition-colors duration-200 relative block hover:text-gray-900 text-gray-500" href="/make-advent-calendar-2020/005-c-and-f-option"><p>-C オプションと -f オプション</p></a></li><li><a class="py-2 transition-colors duration-200 relative block hover:text-gray-900 text-gray-500" href="/make-advent-calendar-2020/006-default-target"><p>デフォルトターゲット</p></a></li><li><a class="py-2 transition-colors duration-200 relative block hover:text-gray-900 text-gray-500" href="/make-advent-calendar-2020/007-exit-status"><p>終了ステータス</p></a></li><li><a class="py-2 transition-colors duration-200 relative block hover:text-gray-900 text-gray-500" href="/make-advent-calendar-2020/008-text-functions"><p>文字列の関数</p></a></li><li><a class="py-2 transition-colors duration-200 relative block hover:text-gray-900 text-gray-500" href="/make-advent-calendar-2020/009-functions-for-filenames"><p>ファイル名の関数</p></a></li><li><a class="py-2 transition-colors duration-200 relative block hover:text-gray-900 text-gray-500" href="/make-advent-calendar-2020/010-functions-for-lists"><p>リストの関数</p></a></li><li><a class="py-2 transition-colors duration-200 relative block hover:text-gray-900 text-gray-500" href="/make-advent-calendar-2020/011-shell-function"><p>shell 関数</p></a></li></ul></li></ul></nav></section><section class="col-span-12 lg:max-w-4xl px-6"><article><div class="py-4 lg:py-8"><p class="mt-1 text-sm text-gray-500">December 03, 2020</p><div class="markdown"><h1>変数</h1>
<p>変数は make の特徴的な2つの側面に大きく関わる要素です。「O'Reilly GNU Make 第3版」3章の冒頭からの引用です。</p>
<blockquote>
<p>make がある意味で2つの言語を1つにしたものだと理解することは重要です。
1つはターゲットを必須項目から成る依存関係グラフを表現します。 もう1つはテキストの置換を行うマクロ言語です。
他のマクロ言語つまりCのプリプロセッサ、m4、TeX、マクロアセンブラについてはよくご存知かと思います。
それらのマクロ言語と同じように、make のマクロも長い文字列を短い単語で定義し、短い単語を使ってプログラムを書くことが出来ます。
マクロプロセッサは短い単語を認識し、それを長い文字列に展開します。</p>
</blockquote>
<h2>簡単な変数</h2>
<p>変数の定義にはいくつかパターンがありますが、簡単な例から見ていきましょう。
変数 <code class="language-text">MESSAGE</code> を <code class="language-text">:=</code> 演算子で定義して、<code class="language-text">$()</code> で展開します（※1）。</p>
<div class="gatsby-highlight" data-language="makefile"><pre style="counter-reset: linenumber NaN" class="language-makefile line-numbers"><code class="language-makefile"><span class="token builtin">.PHONY</span><span class="token punctuation">:</span> hello

MESSAGE <span class="token operator">:=</span> hello

<span class="token symbol">hello</span><span class="token punctuation">:</span>
	echo <span class="token variable">$</span><span class="token punctuation">(</span>MESSAGE<span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>この Makefile は変数 <code class="language-text">MESSAGE</code> を出力します。この変数は make の変数で、実行時には既に展開された形になっています。</p>
<div class="gatsby-highlight" data-language="shell"><pre style="counter-reset: linenumber NaN" class="language-shell line-numbers"><code class="language-shell">$ <span class="token function">make</span> hello
<span class="token builtin class-name">echo</span> hello
hello</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>
<p>make の変数が便利なのは、実行時引数でこれを上書きできるところです。これによって Makefile に容易に拡張性を持たせられます。</p>
<div class="gatsby-highlight" data-language="shell"><pre style="counter-reset: linenumber NaN" class="language-shell line-numbers"><code class="language-shell">$ <span class="token function">make</span> hello <span class="token assign-left variable">MESSAGE</span><span class="token operator">=</span>konnnichiwa
<span class="token builtin class-name">echo</span> konnnichiwa
konnnichiwa</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>
<p>例えば、ある言語のバージョンを上げたいとき、2つのバイナリを用意しておいて、それぞれで同じターゲットを実行する、といった使い方が出来ます。</p>
<div class="gatsby-highlight" data-language="makefile"><pre style="counter-reset: linenumber NaN" class="language-makefile line-numbers"><code class="language-makefile"><span class="token builtin">.PHONY</span><span class="token punctuation">:</span> py

PYTHON <span class="token operator">=</span> python

<span class="token symbol">py</span><span class="token punctuation">:</span>
	<span class="token variable">$</span><span class="token punctuation">(</span>PYTHON<span class="token punctuation">)</span> main.py</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<div class="gatsby-highlight" data-language="shell"><pre style="counter-reset: linenumber NaN" class="language-shell line-numbers"><code class="language-shell">$ <span class="token function">make</span> py
python main.py
psyche
$ <span class="token function">make</span> py <span class="token assign-left variable">PYTHON</span><span class="token operator">=</span>python3
python3 main.py
  File <span class="token string">"main.py"</span>, line <span class="token number">1</span>
    print <span class="token string">"psyche"</span>
                 ^
SyntaxError: Missing parentheses <span class="token keyword">in</span> call to <span class="token string">'print'</span><span class="token builtin class-name">.</span> Did you mean print<span class="token punctuation">(</span><span class="token string">"psyche"</span><span class="token punctuation">)</span>?
make: *** <span class="token punctuation">[</span>Makefile:15: py<span class="token punctuation">]</span> Error <span class="token number">1</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<h2>変数名の大文字小文字</h2>
<p>make の変数は case-sensitive、つまり <code class="language-text">FOO</code> <code class="language-text">Foo</code> <code class="language-text">foo</code> はそれぞれ別の変数として扱われます。</p>
<p>公式ドキュメントには「利用者がコマンドオプションで上書きするパラメタ的な変数や、暗黙のルール（<a href="https://www.gnu.org/software/make/manual/html_node/Implicit-Rules.html">Implicit Rule</a>）を制御する変数には、大文字を使うことを推奨する」とあります。
また、内部的な変数には小文字を使うことを推奨しています。</p>
<blockquote>
<p>It is traditional to use upper case letters in variable names,
but we recommend using lower case letters for variable names that serve internal purposes in the makefile,
and reserving upper case for parameters that control implicit rules or for parameters that the user should override with command options</p>
</blockquote>
<p><a href="https://www.gnu.org/software/make/manual/html_node/Using-Variables.html">https://www.gnu.org/software/make/manual/html_node/Using-Variables.html</a></p>
<h2>リスト</h2>
<p>make は本来の用途で多くのファイルを扱うため、リストを表現する手段を持っています。
リストはスペース区切りの文字列です。</p>
<p>リストは様々な用途に使えますが、一例としてターゲット名に使えます。
この例では、非リストの <code class="language-text">greeting</code> とリストの <code class="language-text">greetings</code> をターゲットに指定し、結果として変数に含まれている値がターゲットとして扱われています。</p>
<div class="gatsby-highlight" data-language="makefile"><pre style="counter-reset: linenumber NaN" class="language-makefile line-numbers"><code class="language-makefile">greeting <span class="token operator">:=</span> holla
greetings <span class="token operator">:=</span> ciao mhoro talofa

<span class="token symbol"><span class="token variable">$</span>(greeting)</span><span class="token punctuation">:</span>
	echo <span class="token string">"greeting"</span>

<span class="token symbol"><span class="token variable">$</span>(greetings)</span><span class="token punctuation">:</span>
	echo <span class="token string">"greetings"</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<div class="gatsby-highlight" data-language="shell"><pre style="counter-reset: linenumber NaN" class="language-shell line-numbers"><code class="language-shell">$ <span class="token function">make</span> holla
<span class="token builtin class-name">echo</span> <span class="token string">"greeting"</span>
greeting
$ <span class="token function">make</span> ciao
<span class="token builtin class-name">echo</span> <span class="token string">"greetings"</span>
greetings
$ <span class="token function">make</span> mhoro talofa
<span class="token builtin class-name">echo</span> <span class="token string">"greetings"</span>
greetings
<span class="token builtin class-name">echo</span> <span class="token string">"greetings"</span>
greetings</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<h2>変数の定義方法</h2>
<p>make には変数の定義方法が複数あります。</p>
<div class="gatsby-highlight" data-language="makefile"><pre style="counter-reset: linenumber NaN" class="language-makefile line-numbers"><code class="language-makefile">immediate   <span class="token operator">:=</span> value
lazy         <span class="token operator">=</span> value
conditional <span class="token operator">?=</span> value
append      <span class="token operator">+=</span> value
append      <span class="token operator">+=</span> value</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p><code class="language-text">+=</code> はリストに要素を追加する演算子ですが、残り3つは「いつ評価されるか」に違いがあります。</p>
<p><code class="language-text">:=</code> で表されるものは「単純展開変数（Simply Expanded Variable）」、<code class="language-text">=</code> で表されるものは「再帰展開変数（Recursively Expanded Variable）」（または「遅延評価変数（Lazy Expanded Variable）」）、<code class="language-text">?=</code> で表されるものは「条件付き代入変数（Conditional Variable）」と呼ばれます。</p>
<p>簡潔に言えば、<code class="language-text">:=</code> は一度だけ評価され、<code class="language-text">=</code> は変数展開する毎に評価される可能性があり、<code class="language-text">?=</code> は値を持たないときだけ評価されます。</p>
<p>問題になりやすいのが <code class="language-text">=</code> で、ターゲットをまたがった際など、必要と判断されると再評価されて値が変わってしまうことがあります。</p>
<div class="gatsby-highlight" data-language="makefile"><pre style="counter-reset: linenumber NaN" class="language-makefile line-numbers"><code class="language-makefile"><span class="token builtin">.PHONY</span><span class="token punctuation">:</span> test a sleep b

immediate <span class="token operator">:=</span> <span class="token variable">$</span><span class="token punctuation">(</span><span class="token keyword">shell</span> date +%s<span class="token punctuation">)</span>
lazy       <span class="token operator">=</span> <span class="token variable">$</span><span class="token punctuation">(</span><span class="token keyword">shell</span> date +%s<span class="token punctuation">)</span>

<span class="token symbol">test</span><span class="token punctuation">:</span> a sleep b

<span class="token symbol">a</span><span class="token punctuation">:</span>
	echo <span class="token variable">$</span><span class="token punctuation">(</span>immediate<span class="token punctuation">)</span> <span class="token comment"># immediate</span>
	echo <span class="token variable">$</span><span class="token punctuation">(</span>lazy<span class="token punctuation">)</span> <span class="token comment"># lazy</span>

<span class="token symbol">sleep</span><span class="token punctuation">:</span>
	sleep 3

<span class="token symbol">b</span><span class="token punctuation">:</span>
	echo <span class="token variable">$</span><span class="token punctuation">(</span>immediate<span class="token punctuation">)</span> <span class="token comment"># immediate</span>
	echo <span class="token variable">$</span><span class="token punctuation">(</span>lazy<span class="token punctuation">)</span> <span class="token comment"># lazy</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>このように immediate が変わらないのに対して、lazy が再評価されます。</p>
<div class="gatsby-highlight" data-language="shell"><pre style="counter-reset: linenumber NaN" class="language-shell line-numbers"><code class="language-shell">$ <span class="token function">make</span> <span class="token builtin class-name">test</span>
<span class="token builtin class-name">echo</span> <span class="token number">1607153140</span> <span class="token comment"># immediate</span>
<span class="token number">1607153140</span>
<span class="token builtin class-name">echo</span> <span class="token number">1607153140</span> <span class="token comment"># lazy</span>
<span class="token number">1607153140</span>
<span class="token function">sleep</span> <span class="token number">3</span>
<span class="token builtin class-name">echo</span> <span class="token number">1607153140</span> <span class="token comment"># immediate</span>
<span class="token number">1607153140</span>
<span class="token builtin class-name">echo</span> <span class="token number">1607153143</span> <span class="token comment"># lazy</span>
<span class="token number">1607153143</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>特別な意図がない限り <code class="language-text">:=</code> （単純展開変数）を使うようにすればよいでしょう。</p>
<h2>リンク</h2>
<ul>
<li><a href="https://nekonenene.hatenablog.com/entry/2019/02/11/070021">https://nekonenene.hatenablog.com/entry/2019/02/11/070021</a></li>
<li><a href="https://www.gnu.org/software/make/manual/html_node/Flavors.html">https://www.gnu.org/software/make/manual/html_node/Flavors.html</a></li>
<li><a href="https://qiita.com/kojiohta/items/54b1a9f7d482c35dc4fa">https://qiita.com/kojiohta/items/54b1a9f7d482c35dc4fa</a></li>
</ul>
<p>※1. <code class="language-text">$()</code> の他にも <code class="language-text">${}</code> でも展開できますし、特殊なパターンとして変数名が一文字の場合は <code class="language-text">$</code> で展開出来ます。複数の書き方が混在するのは好ましくないので、<code class="language-text">$()</code> に統一するのがよいのではないでしょうか。</p></div></div></article><section class="min-w-0 w-full col-span-2 sm:px-2"><nav><ul class="flex flex-wrap justify-between mb-8"><li><a class="text-blue-600" rel="prev" href="/make-advent-calendar-2020/002-phony-target-and-prerequisites">← <!-- -->偽のターゲットと前提条件</a></li><li><a class="text-blue-600" rel="next" href="/make-advent-calendar-2020/004-automatic-variable">自動変数<!-- --> →</a></li></ul></nav></section></section></section></main><footer class="bottom-0 h-8 bg-emerald-500 text-sm items-center justify-center"><p class="text-center">© <!-- -->2020<!-- -->, Built with<!-- --> <a href="https://www.gatsbyjs.com">Gatsby</a></p></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-K29D3L3XGS"></script><script>
      
      
      if(true) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){window.dataLayer && window.dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-K29D3L3XGS', {"send_page_view":false});
      }
      </script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/003-variable";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-ca8adf9770cfeec4c092.js"],"app":["/app-f6a66f2b14543ebf23ed.js"],"component---src-pages-404-js":["/component---src-pages-404-js-9c04155390b493ad90ef.js"],"component---src-pages-index-js":["/component---src-pages-index-js-7dbc1a10d2512dec6573.js"],"component---src-templates-markdown-js":["/component---src-templates-markdown-js-4b34ef1e8d6d1952574a.js"]};/*]]>*/</script><script src="/make-advent-calendar-2020/polyfill-ca8adf9770cfeec4c092.js" nomodule=""></script><script src="/make-advent-calendar-2020/component---src-templates-markdown-js-4b34ef1e8d6d1952574a.js" async=""></script><script src="/make-advent-calendar-2020/commons-783e0f477cc80a177ea6.js" async=""></script><script src="/make-advent-calendar-2020/styles-407fe62976dc5310c43e.js" async=""></script><script src="/make-advent-calendar-2020/app-f6a66f2b14543ebf23ed.js" async=""></script><script src="/make-advent-calendar-2020/framework-83e11af5cf111be5ad89.js" async=""></script><script src="/make-advent-calendar-2020/webpack-runtime-c00f8d02308ea544b904.js" async=""></script></body></html>