{"componentChunkName":"component---src-templates-markdown-js","path":"/008-text-functions","result":{"data":{"markdownRemark":{"html":"<h1>文字列の関数</h1>\n<p>make の関数は <code class=\"language-text\">$(function arguments)</code> の形式で呼び出します。\narguments はカンマ（<code class=\"language-text\">,</code>）区切りで複数指定できますし、空白区切りのリストも指定できます。</p>\n<p>文字列に関する関数はいくつかありますが、主に使うのが <code class=\"language-text\">subst</code> と <code class=\"language-text\">patsubst</code> です。</p>\n<h2>subst</h2>\n<p>subst は単純に文字列を置換する関数です。</p>\n<div class=\"gatsby-highlight\" data-language=\"makefile\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-makefile line-numbers\"><code class=\"language-makefile\"><span class=\"token variable\">$</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">subst</span> from,to,text<span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"makefile\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-makefile line-numbers\"><code class=\"language-makefile\"><span class=\"token symbol\">subst</span><span class=\"token punctuation\">:</span>\n\techo <span class=\"token variable\">$</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">subst</span> og,xx,hoge<span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-shell line-numbers\"><code class=\"language-shell\">$ <span class=\"token function\">make</span> subst\n<span class=\"token builtin class-name\">echo</span> hxxe\nhxxe</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<h2>patsubst</h2>\n<p>patsbust は簡単なパターン置換を行う関数です。</p>\n<div class=\"gatsby-highlight\" data-language=\"makefile\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-makefile line-numbers\"><code class=\"language-makefile\"><span class=\"token variable\">$</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">patsubst</span> pattern,replacement,text<span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p><code class=\"language-text\">%</code> を含むパターンを置換します。</p>\n<div class=\"gatsby-highlight\" data-language=\"makefile\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-makefile line-numbers\"><code class=\"language-makefile\"><span class=\"token symbol\">patsubst</span><span class=\"token punctuation\">:</span>\n\techo <span class=\"token variable\">$</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">patsubst</span> %a,%,hoge fuga vaa<span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-shell line-numbers\"><code class=\"language-shell\">$ <span class=\"token function\">make</span> patsubst\n<span class=\"token builtin class-name\">echo</span> hoge fug va\nhoge fug va</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<h2>代用参照</h2>\n<p>シェルの変数展開（<a href=\"https://pubs.opengroup.org/onlinepubs/009604499/utilities/xcu_chap02.html#tag_02_06_02\">Parameter Expansion</a>）のように、\n文字列を置換できるのが「代用参照（<a href=\"https://www.gnu.org/software/make/manual/make.html#Substitution-Refs\">Substitution Reference</a>）です。</p>\n<div class=\"gatsby-highlight\" data-language=\"makefile\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-makefile line-numbers\"><code class=\"language-makefile\"><span class=\"token symbol\"><span class=\"token variable\">$</span>(var</span><span class=\"token punctuation\">:</span>pattern<span class=\"token operator\">=</span>replacement<span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>代用参照は patsubst と同じように動くので、先程の例はこのように書けます。\n一度変数に格納しないといけませんが、短く書けます。</p>\n<div class=\"gatsby-highlight\" data-language=\"makefile\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-makefile line-numbers\"><code class=\"language-makefile\">var <span class=\"token operator\">:=</span> hoge fuga vaa\n\n<span class=\"token symbol\">subst-ref</span><span class=\"token punctuation\">:</span>\n<span class=\"token symbol\">\t<span class=\"token variable\">$</span>(var</span><span class=\"token punctuation\">:</span>%a<span class=\"token operator\">=</span>%<span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-shell line-numbers\"><code class=\"language-shell\">$ <span class=\"token function\">make</span> subst-ref\n<span class=\"token builtin class-name\">echo</span> hoge fug va\nhoge fug va</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<h2>残念なカンマ</h2>\n<p>なんとも残念な感じですが、make の関数呼び出しではカンマ（<code class=\"language-text\">,</code>）が扱えません。\nエスケープする手段もないため、このように一度変数化して展開する必要があります。</p>\n<div class=\"gatsby-highlight\" data-language=\"makefile\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-makefile line-numbers\"><code class=\"language-makefile\">clist <span class=\"token operator\">:=</span> hoge,fuga,vaa\ncomma <span class=\"token operator\">:=</span> ,\n\n<span class=\"token symbol\">comma</span><span class=\"token punctuation\">:</span>\n\techo <span class=\"token variable\">$</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">subst</span> <span class=\"token variable\">$</span><span class=\"token punctuation\">(</span>comma<span class=\"token punctuation\">)</span>, , <span class=\"token variable\">$</span><span class=\"token punctuation\">(</span>clist<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-shell line-numbers\"><code class=\"language-shell\">$ <span class=\"token function\">make</span> comma\n<span class=\"token builtin class-name\">echo</span> hoge\nhoge</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>凝ったことをしない限りこれに困らされることはありませんが、やはり特性にあった使い方をするのが大事かなと思います。</p>\n<h2>リンク</h2>\n<ul>\n<li><a href=\"https://pubs.opengroup.org/onlinepubs/009604499/utilities/xcu_chap02.html#tag_02_06_02\">https://pubs.opengroup.org/onlinepubs/009604499/utilities/xcu<em>chap02.html#tag</em>02<em>06</em>02</a></li>\n<li><a href=\"https://www.gnu.org/software/make/manual/make.html#Substitution-Refs\">https://www.gnu.org/software/make/manual/make.html#Substitution-Refs</a></li>\n</ul>","excerpt":"文字列の関数 make の関数は  の形式で呼び出します。\narguments はカンマ（）区切りで複数指定できますし、空白区切りのリストも指定できます。 文字列に関する関数はいくつかありますが、主に使うのが  と  です。 subst subst は単純に文字列を置換する関数です。 patsubst patsbus…","frontmatter":{"date":"December 08, 2020","slug":"/008-text-functions","title":"文字列の関数"}}},"pageContext":{"slug":"/008-text-functions","nodes":[{"node":{"frontmatter":{"slug":"/001-makefile-in-2020","title":"2020年の Makefile"}}},{"node":{"frontmatter":{"slug":"/002-phony-target-and-prerequisites","title":"偽のターゲットと前提条件"}}},{"node":{"frontmatter":{"slug":"/003-variable","title":"変数"}}},{"node":{"frontmatter":{"slug":"/004-automatic-variable","title":"自動変数"}}},{"node":{"frontmatter":{"slug":"/005-c-and-f-option","title":"-C オプションと -f オプション"}}},{"node":{"frontmatter":{"slug":"/006-default-target","title":"デフォルトターゲット"}}},{"node":{"frontmatter":{"slug":"/007-exit-status","title":"終了ステータス"}}},{"node":{"frontmatter":{"slug":"/008-text-functions","title":"文字列の関数"}}}]}},"staticQueryHashes":["3649515864","63159454"]}